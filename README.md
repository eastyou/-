# 希沃白板防误触锁定工具
一款用于教育场景的电脑锁定工具，可防止学生在课堂中随意操作希沃白板或教学电脑，支持自动锁屏、异常操作抓拍及远程报警功能。
功能特点

定时自动锁屏：可设置每日特定时间段自动锁屏
多重解锁方式：支持密码解锁和 USB 密钥解锁（F12 触发检测）
异常监控：检测到非法操作时自动启用摄像头抓拍并发送邮件报警
异常关机检测：重启后检测到上次异常关机时自动报警
红色闪烁警告：非法触碰时显示全屏红色警告提示
安装说明

环境要求

Python 3.6+
Windows 系统（依赖部分 WindowsAPI，暂不支持 macOS/Linux）
带摄像头的设备（用于抓拍功能）
依赖安装

bash


运行




pip install -r requirements.txt
requirements.txt 内容：
plaintext





PyQt5>=5.15.4
opencv-python>=4.5.3
pynput>=1.7.3
使用教程

首次使用配置

克隆或下载项目到本地
修改代码中SMTP_INFO和ADMIN_EMAIL配置（建议通过配置文件修改，见下方配置说明）
运行程序自动生成密钥文件：python lock_tool.py，生成的unlock.key文件保存到管理员 U 盘中（用于紧急解锁）
基本操作

启动程序后，在主界面设置：
锁屏时长（分钟）
解锁密码（至少 6 位，需包含字母和数字）
每日自动锁屏的开始 / 结束时间
点击 "启动后台守护" 按钮，程序将在设定时间段内自动锁屏
锁屏状态下：
输入正确密码并点击 "解锁" 按钮解锁
插入包含unlock.key的 U 盘，按 F12 可强制解锁
配置说明

敏感信息配置（推荐）

建议创建config.ini文件管理配置（需与lock_tool.py同目录）：
ini





[SMTP]
server = smtp.gmail.com
port = 587
sender = your_email@gmail.com
password = your_app_password

[ADMIN]
email = admin@domain.com
程序会优先读取配置文件，若未找到则使用代码中默认配置。
关键文件说明

unlock.key：管理员密钥文件，用于紧急解锁，生成后请妥善保存到 U 盘
lock_status.txt：锁屏状态记录文件，用于检测异常关机
注意事项

隐私保护：
抓拍功能仅在检测到非法操作时触发
请提前告知使用场景下的人员关于监控功能的存在
摄像头权限：
确保程序拥有摄像头使用权限，否则抓拍功能无法正常工作
邮件配置：
若使用 Gmail，需开启 "Less secure app access" 或使用应用专用密码
其他邮箱请参考对应 SMTP 服务器配置（如 QQ 邮箱、163 邮箱等）
异常处理：
若摄像头无法启动，程序会跳过抓拍但仍会触发锁屏
邮件发送失败时会在控制台输出错误信息
许可证

本项目采用 MIT 许可证开源，详情参见 LICENSE 文件。
贡献指南

欢迎提交 Issue 或 Pull Request 改进本工具，主要优化方向：
增加多语言支持
适配更多操作系统
优化 UI 界面
增加更多解锁方式（如人脸识别）# 希沃白板防误触锁定工具
一款用于教育场景的电脑锁定工具，可防止学生在课堂中随意操作希沃白板或教学电脑，支持自动锁屏、异常操作抓拍及远程报警功能。
功能特点

定时自动锁屏：可设置每日特定时间段自动锁屏
多重解锁方式：支持密码解锁和 USB 密钥解锁（F12 触发检测）
异常监控：检测到非法操作时自动启用摄像头抓拍并发送邮件报警
异常关机检测：重启后检测到上次异常关机时自动报警
红色闪烁警告：非法触碰时显示全屏红色警告提示
安装说明

环境要求

Python 3.6+
Windows 系统（依赖部分 WindowsAPI，暂不支持 macOS/Linux）
带摄像头的设备（用于抓拍功能）
依赖安装

bash


运行




pip install -r requirements.txt
requirements.txt 内容：
plaintext





PyQt5>=5.15.4
opencv-python>=4.5.3
pynput>=1.7.3
使用教程

首次使用配置

克隆或下载项目到本地
修改代码中SMTP_INFO和ADMIN_EMAIL配置（建议通过配置文件修改，见下方配置说明）
运行程序自动生成密钥文件：python lock_tool.py，生成的unlock.key文件保存到管理员 U 盘中（用于紧急解锁）
基本操作

启动程序后，在主界面设置：
锁屏时长（分钟）
解锁密码（至少 6 位，需包含字母和数字）
每日自动锁屏的开始 / 结束时间
点击 "启动后台守护" 按钮，程序将在设定时间段内自动锁屏
锁屏状态下：
输入正确密码并点击 "解锁" 按钮解锁
插入包含unlock.key的 U 盘，按 F12 可强制解锁
配置说明

敏感信息配置（推荐）

建议创建config.ini文件管理配置（需与lock_tool.py同目录）：
ini





[SMTP]
server = smtp.gmail.com
port = 587
sender = your_email@gmail.com
password = your_app_password

[ADMIN]
email = admin@domain.com
程序会优先读取配置文件，若未找到则使用代码中默认配置。
关键文件说明

unlock.key：管理员密钥文件，用于紧急解锁，生成后请妥善保存到 U 盘
lock_status.txt：锁屏状态记录文件，用于检测异常关机
注意事项

隐私保护：
抓拍功能仅在检测到非法操作时触发
请提前告知使用场景下的人员关于监控功能的存在
摄像头权限：
确保程序拥有摄像头使用权限，否则抓拍功能无法正常工作
邮件配置：
若使用 Gmail，需开启 "Less secure app access" 或使用应用专用密码
其他邮箱请参考对应 SMTP 服务器配置（如 QQ 邮箱、163 邮箱等）
异常处理：
若摄像头无法启动，程序会跳过抓拍但仍会触发锁屏
邮件发送失败时会在控制台输出错误信息
许可证

本项目采用 MIT 许可证开源，详情参见 LICENSE 文件。
贡献指南

欢迎提交 Issue 或 Pull Request 改进本工具，主要优化方向：
增加多语言支持
适配更多操作系统
优化 UI 界面
增加更多解锁方式（如人脸识别）
